(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{447:function(a,e,t){"use strict";t.r(e);var s=t(1),r=Object(s.a)({},(function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"调试时的事件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#调试时的事件"}},[a._v("#")]),a._v(" 调试时的事件")]),a._v(" "),t("p",[a._v("接口调试时分别触发"),t("code",[a._v("before")]),a._v("请求发起前事件，与"),t("code",[a._v("after")]),a._v("请求响应后事件。")]),a._v(" "),t("p",[a._v("可通过接口的注解来定义执行的事件，如下：")]),a._v(" "),t("div",{staticClass:"language-php line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v('/**\n * @Apidoc\\Title ("调试时事件")\n * @Apidoc\\Url("/admin/demo/debug")\n * @Apidoc\\Param("name",type="string",desc="姓名")\n * @Apidoc\\Param("phone",type="string",desc="性别")\n * @Apidoc\\Param("myValue",type="string",desc="我的临时请求头参数")\n * @Apidoc\\Before(event="setHeader",key="myHeader",value="params.myValue")\n * @Apidoc\\Before(event="clearParam",key="myValue")\n * @Apidoc\\After(event="setGlobalHeader",key="myGHeader",value="res.data.data.myGHeader",desc="我的全局Header参数")\n * @Apidoc\\After(event="setGlobalParam",key="myGParam",value="123456",desc="我的全局参数")\n */')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("debug")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name type-declaration"}},[a._v("Request")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$request")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//...")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br"),t("span",{staticClass:"line-number"},[a._v("13")]),t("br"),t("span",{staticClass:"line-number"},[a._v("14")]),t("br")])]),t("p",[a._v("以上例子中，会执行以下事件：")]),a._v(" "),t("p",[a._v("1、请求发起前，设置一个请求头参数"),t("code",[a._v("myHeader")]),a._v("，参数值为请求参数中的"),t("code",[a._v("myValue")]),a._v("参数。")]),a._v(" "),t("p",[a._v("2、请求发起前，清除请求参数"),t("code",[a._v("myValue")]),a._v("。")]),a._v(" "),t("p",[a._v("3、请求响应后，设置一个全局请求头参数"),t("code",[a._v("myGHeader")]),a._v("，参数值为响应结果中返回数据中的"),t("code",[a._v("data.myGHeader")]),a._v("。")]),a._v(" "),t("p",[a._v("4、请求响应后，设置一个全局请求参数"),t("code",[a._v("myGParam")]),a._v("，参数值为"),t("code",[a._v("123456")]),a._v("。")]),a._v(" "),t("h2",{attrs:{id:"before-after注解的参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#before-after注解的参数"}},[a._v("#")]),a._v(" Before|After注解的参数")]),a._v(" "),t("table",[t("thead",[t("tr",[t("th",[a._v("参数名")]),a._v(" "),t("th",[a._v("说明")])])]),a._v(" "),t("tbody",[t("tr",[t("td",[a._v("event")]),a._v(" "),t("td",[a._v("事件名")])]),a._v(" "),t("tr",[t("td",[a._v("key")]),a._v(" "),t("td",[a._v("字段名")])]),a._v(" "),t("tr",[t("td",[a._v("value")]),a._v(" "),t("td",[a._v("字段值，可直接设置值，或以"),t("code",[a._v("params.xxx")]),a._v("取请求参数中的值；以"),t("code",[a._v("res.xxx")]),a._v("取请求响应结果中的参数")])]),a._v(" "),t("tr",[t("td",[a._v("desc")]),a._v(" "),t("td",[a._v("字段描述")])]),a._v(" "),t("tr",[t("td",[a._v("url")]),a._v(" "),t("td",[a._v("event为ajax时，定义请求地址")])]),a._v(" "),t("tr",[t("td",[a._v("method")]),a._v(" "),t("td",[a._v("event为ajax时，定义请求类型")])]),a._v(" "),t("tr",[t("td",[a._v("contentType")]),a._v(" "),t("td",[a._v("event为ajax时，定义contentType")])])])]),a._v(" "),t("h2",{attrs:{id:"事件说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#事件说明"}},[a._v("#")]),a._v(" 事件说明")]),a._v(" "),t("h3",{attrs:{id:"setheader"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#setheader"}},[a._v("#")]),a._v(" setHeader")]),a._v(" "),t("blockquote",[t("p",[t("code",[a._v("before")]),a._v("请求发起前有效")])]),a._v(" "),t("p",[a._v("设置一个请求头参数")]),a._v(" "),t("p",[t("code",[a._v('@Apidoc\\Before(event="setHeader",key="参数名",value="参数值")')])]),a._v(" "),t("h3",{attrs:{id:"setglobalheader"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#setglobalheader"}},[a._v("#")]),a._v(" setGlobalHeader")]),a._v(" "),t("p",[a._v("设置一个全局请求头参数")]),a._v(" "),t("p",[t("code",[a._v('@Apidoc\\After(event="setGlobalHeader",key="参数名",value="参数值",desc="参数描述")')])]),a._v(" "),t("h3",{attrs:{id:"clearglobalheader"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#clearglobalheader"}},[a._v("#")]),a._v(" clearGlobalHeader")]),a._v(" "),t("p",[a._v("清除一个全局请求头参数")]),a._v(" "),t("p",[t("code",[a._v('@Apidoc\\Before(event="clearGlobalHeader",key="参数名")')])]),a._v(" "),t("h3",{attrs:{id:"setparam"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#setparam"}},[a._v("#")]),a._v(" setParam")]),a._v(" "),t("blockquote",[t("p",[t("code",[a._v("before")]),a._v("请求发起前有效")])]),a._v(" "),t("p",[a._v("设置一个请求参数")]),a._v(" "),t("p",[t("code",[a._v('@Apidoc\\Before(event="setParam",key="参数名",value="参数值")')])]),a._v(" "),t("h3",{attrs:{id:"clearparam"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#clearparam"}},[a._v("#")]),a._v(" clearParam")]),a._v(" "),t("p",[a._v("清除一个请求参数")]),a._v(" "),t("p",[t("code",[a._v('@Apidoc\\Before(event="clearParam",key="参数名")')])]),a._v(" "),t("h3",{attrs:{id:"handleparam"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#handleparam"}},[a._v("#")]),a._v(" handleParam")]),a._v(" "),t("p",[a._v("处理一个请求参数，key仅支持"),t("code",[a._v("md5")])]),a._v(" "),t("p",[t("code",[a._v('@Apidoc\\Before(event="handleParam",key="md5",value="参数值")')])]),a._v(" "),t("h3",{attrs:{id:"setglobalparam"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#setglobalparam"}},[a._v("#")]),a._v(" setGlobalParam")]),a._v(" "),t("p",[a._v("设置一个全局请求参数")]),a._v(" "),t("p",[t("code",[a._v('@Apidoc\\Before(event="setGlobalParam",key="参数名",value="参数值")')])]),a._v(" "),t("h3",{attrs:{id:"clearglobalparam"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#clearglobalparam"}},[a._v("#")]),a._v(" clearGlobalParam")]),a._v(" "),t("p",[a._v("清除一个全局请求参数")]),a._v(" "),t("p",[t("code",[a._v('@Apidoc\\Before(event="clearGlobalParam",key="参数名")')])]),a._v(" "),t("h3",{attrs:{id:"ajax"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ajax"}},[a._v("#")]),a._v(" ajax")]),a._v(" "),t("p",[a._v("发送一个请求")]),a._v(" "),t("div",{staticClass:"language-php line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("**")]),a._v("\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" @Apidoc\\"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("Before")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("event"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[a._v('"ajax"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("url"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[a._v('"请求地址"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("method"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[a._v('"请求类型"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("contentType"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[a._v('"appicateion-json"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v("    @Apidoc\\"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("Before")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("event"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[a._v('"setParam"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("key"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[a._v('"key"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("value"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[a._v('"params.phone"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v("    @Apidoc\\"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("Before")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("event"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[a._v('"setParam"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("key"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[a._v('"abc"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("value"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[a._v('"123456"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v("    @Apidoc\\"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("After")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("event"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[a._v('"setHeader"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("key"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[a._v('"X-CSRF-TOKEN"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("value"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[a._v('"res.data.data"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br")])]),t("p",[a._v("以上注解，会在接口调试前发送一个请求，请求参数为"),t("code",[a._v('{key:"这个值为调试接口参数的phone字段",abc:"123456"}')]),a._v("，请求响应后执行"),t("code",[a._v("setHeader")]),a._v("设置一个key为"),t("code",[a._v("X-CSRF-TOKEN")]),a._v("的请求头参数，值为该请求返回值中的"),t("code",[a._v("res.data.data")])])])}),[],!1,null,null,null);e.default=r.exports}}]);